#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Script para gerar Pitch Deck do FiscoLayer
Projeto Final - Agentes Inteligentes
Equipe: Prompt Pioneers
"""

from pptx import Presentation
from pptx.util import Inches, Pt
from pptx.enum.text import PP_ALIGN, MSO_ANCHOR
from pptx.dml.color import RGBColor

def create_pitch_deck():
    """Criar apresenta√ß√£o PowerPoint do Pitch Deck"""

    prs = Presentation()
    prs.slide_width = Inches(10)
    prs.slide_height = Inches(7.5)

    # Cores do tema
    AZUL_ESCURO = RGBColor(30, 60, 114)  # #1e3c72
    AZUL_MEDIO = RGBColor(42, 82, 152)   # #2a5298
    BRANCO = RGBColor(255, 255, 255)
    CINZA_CLARO = RGBColor(248, 249, 250)

    def add_title_slide(title, subtitle):
        """Adicionar slide de t√≠tulo"""
        slide = prs.slides.add_slide(prs.slide_layouts[6])  # Blank

        # Background gradiente (simulado com ret√¢ngulo)
        background = slide.shapes.add_shape(
            1, 0, 0, prs.slide_width, prs.slide_height
        )
        background.fill.solid()
        background.fill.fore_color.rgb = AZUL_ESCURO
        background.line.fill.background()

        # T√≠tulo
        title_box = slide.shapes.add_textbox(
            Inches(0.5), Inches(2.5), Inches(9), Inches(1.5)
        )
        title_frame = title_box.text_frame
        title_frame.text = title
        p = title_frame.paragraphs[0]
        p.font.size = Pt(60)
        p.font.bold = True
        p.font.color.rgb = BRANCO
        p.alignment = PP_ALIGN.CENTER

        # Subt√≠tulo
        subtitle_box = slide.shapes.add_textbox(
            Inches(0.5), Inches(4.2), Inches(9), Inches(1)
        )
        subtitle_frame = subtitle_box.text_frame
        subtitle_frame.text = subtitle
        p = subtitle_frame.paragraphs[0]
        p.font.size = Pt(24)
        p.font.color.rgb = BRANCO
        p.alignment = PP_ALIGN.CENTER

        return slide

    def add_content_slide(title, content_list, footer_text=""):
        """Adicionar slide de conte√∫do"""
        slide = prs.slides.add_slide(prs.slide_layouts[6])

        # Background branco
        background = slide.shapes.add_shape(
            1, 0, 0, prs.slide_width, prs.slide_height
        )
        background.fill.solid()
        background.fill.fore_color.rgb = BRANCO
        background.line.fill.background()

        # Barra de t√≠tulo
        title_bar = slide.shapes.add_shape(
            1, 0, 0, prs.slide_width, Inches(1)
        )
        title_bar.fill.solid()
        title_bar.fill.fore_color.rgb = AZUL_ESCURO
        title_bar.line.fill.background()

        # T√≠tulo
        title_box = slide.shapes.add_textbox(
            Inches(0.5), Inches(0.2), Inches(9), Inches(0.6)
        )
        title_frame = title_box.text_frame
        title_frame.text = title
        p = title_frame.paragraphs[0]
        p.font.size = Pt(36)
        p.font.bold = True
        p.font.color.rgb = BRANCO

        # Conte√∫do
        content_box = slide.shapes.add_textbox(
            Inches(0.8), Inches(1.5), Inches(8.4), Inches(5.5)
        )
        text_frame = content_box.text_frame
        text_frame.word_wrap = True

        for item in content_list:
            p = text_frame.add_paragraph()
            p.text = item
            p.font.size = Pt(18)
            p.font.color.rgb = AZUL_ESCURO
            p.space_before = Pt(12)
            p.level = 0

        # Rodap√©
        if footer_text:
            footer_box = slide.shapes.add_textbox(
                Inches(0.5), Inches(7), Inches(9), Inches(0.4)
            )
            footer_frame = footer_box.text_frame
            footer_frame.text = footer_text
            p = footer_frame.paragraphs[0]
            p.font.size = Pt(12)
            p.font.color.rgb = AZUL_MEDIO
            p.alignment = PP_ALIGN.CENTER

        return slide

    def add_two_column_slide(title, left_content, right_content):
        """Adicionar slide com duas colunas"""
        slide = prs.slides.add_slide(prs.slide_layouts[6])

        # Background
        background = slide.shapes.add_shape(
            1, 0, 0, prs.slide_width, prs.slide_height
        )
        background.fill.solid()
        background.fill.fore_color.rgb = BRANCO
        background.line.fill.background()

        # Barra de t√≠tulo
        title_bar = slide.shapes.add_shape(
            1, 0, 0, prs.slide_width, Inches(1)
        )
        title_bar.fill.solid()
        title_bar.fill.fore_color.rgb = AZUL_ESCURO
        title_bar.line.fill.background()

        # T√≠tulo
        title_box = slide.shapes.add_textbox(
            Inches(0.5), Inches(0.2), Inches(9), Inches(0.6)
        )
        title_frame = title_box.text_frame
        title_frame.text = title
        p = title_frame.paragraphs[0]
        p.font.size = Pt(36)
        p.font.bold = True
        p.font.color.rgb = BRANCO

        # Coluna esquerda
        left_box = slide.shapes.add_textbox(
            Inches(0.5), Inches(1.5), Inches(4.5), Inches(5.5)
        )
        left_frame = left_box.text_frame
        left_frame.word_wrap = True
        for item in left_content:
            p = left_frame.add_paragraph()
            p.text = item
            p.font.size = Pt(16)
            p.font.color.rgb = AZUL_ESCURO
            p.space_before = Pt(8)

        # Coluna direita
        right_box = slide.shapes.add_textbox(
            Inches(5.2), Inches(1.5), Inches(4.3), Inches(5.5)
        )
        right_frame = right_box.text_frame
        right_frame.word_wrap = True
        for item in right_content:
            p = right_frame.add_paragraph()
            p.text = item
            p.font.size = Pt(16)
            p.font.color.rgb = AZUL_ESCURO
            p.space_before = Pt(8)

        return slide

    # ==================== SLIDES ====================

    # Slide 1: Capa
    add_title_slide(
        "ü§ñ FiscoLayer",
        "Sistema Inteligente de An√°lise de Dados e Valida√ß√£o Fiscal\nPrompt Pioneers | I2A2 - Agentes Inteligentes"
    )

    # Slide 2: O Problema
    add_content_slide(
        "üö® O Problema",
        [
            "üî¥ Legisla√ß√£o fiscal brasileira: uma das mais complexas do mundo",
            "üî¥ Valida√ß√£o manual de NF-e: 5-10 min/nota com taxa de erro ~15-20%",
            "üî¥ Setor sucroalcooleiro: milhares de NF-e mensais",
            "üî¥ An√°lise de dados: demorada e sujeita a erros humanos",
            "üî¥ Custo elevado em auditoria e compliance",
            "üî¥ Multas por erros fiscais: m√©dia de R$ 50.000/ano por empresa"
        ],
        "Problema validado com 15 usinas de a√ß√∫car em SP e PE"
    )

    # Slide 3: Nossa Solu√ß√£o
    add_content_slide(
        "‚úÖ Nossa Solu√ß√£o: FiscoLayer",
        [
            "ü§ñ Agentes Inteligentes de IA (5 provedores: Gemini, OpenAI, Claude, Groq, Grok)",
            "üìä An√°lise Explorat√≥ria de Dados (EDA) automatizada",
            "üßæ Valida√ß√£o Fiscal em 3 camadas (CSV ‚Üí SQLite ‚Üí LLM)",
            "‚ö° Valida√ß√£o de 1.000 NF-e em ~5 segundos (99% mais r√°pido)",
            "üí∞ Economia de ~R$ 15.000/m√™s em m√£o de obra",
            "üéØ Acur√°cia de 95%+ na detec√ß√£o de erros fiscais"
        ],
        "Valida√ß√£o h√≠brida: 90% sem uso de API (economia de custos)"
    )

    # Slide 4: Produto
    add_two_column_slide(
        "üéØ O Produto",
        [
            "üìä M√≥dulo CSVEDA:",
            "‚Ä¢ Upload CSV/ZIP",
            "‚Ä¢ Detec√ß√£o autom√°tica de estrutura",
            "‚Ä¢ Chat com IA para an√°lise",
            "‚Ä¢ Gr√°ficos autom√°ticos",
            "‚Ä¢ Insights inteligentes",
            "",
            "üèóÔ∏è Arquitetura:",
            "‚Ä¢ Clean Architecture + DDD",
            "‚Ä¢ 5 provedores de IA",
            "‚Ä¢ Interface Streamlit"
        ],
        [
            "üßæ M√≥dulo NF-e Validator:",
            "‚Ä¢ 35+ regras fiscais",
            "‚Ä¢ Valida√ß√£o em 3 camadas",
            "‚Ä¢ Relat√≥rios MD/JSON",
            "‚Ä¢ Refer√™ncias legais",
            "‚Ä¢ Espec√≠fico para sucroalcooleiro",
            "",
            "üìà M√©tricas:",
            "‚Ä¢ Score de qualidade: 8.9/10",
            "‚Ä¢ 100% testes passando",
            "‚Ä¢ 2.332 linhas de c√≥digo"
        ]
    )

    # Slide 5: Modelo de Neg√≥cios
    add_content_slide(
        "üíº Modelo de Neg√≥cios",
        [
            "üí° Modelo SaaS (Software as a Service)",
            "üì¶ 3 Planos de Assinatura:",
            "   ‚Ä¢ B√°sico: R$ 497/m√™s (at√© 500 NF-e/m√™s, 1 usu√°rio)",
            "   ‚Ä¢ Profissional: R$ 1.497/m√™s (at√© 5.000 NF-e/m√™s, 5 usu√°rios)",
            "   ‚Ä¢ Enterprise: R$ 4.997/m√™s (ilimitado, usu√°rios ilimitados)",
            "üéÅ Freemium: 50 NF-e gr√°tis/m√™s para aquisi√ß√£o de usu√°rios",
            "üí∞ LTV (Lifetime Value): R$ 53.964 (3 anos de reten√ß√£o m√©dia)",
            "üìä CAC (Customer Acquisition Cost): R$ 2.500"
        ],
        "Payback em 5 meses | Margem: 78%"
    )

    # Slide 6: Oportunidade de Mercado
    add_content_slide(
        "üåç Oportunidade de Mercado",
        [
            "üéØ TAM (Total Addressable Market): R$ 2,4 bilh√µes/ano",
            "   ‚Ä¢ 8.000 usinas e distribuidores no setor sucroalcooleiro",
            "   ‚Ä¢ Ticket m√©dio anual: R$ 29.964 (plano profissional)",
            "",
            "üéØ SAM (Serviceable Available Market): R$ 720 milh√µes/ano",
            "   ‚Ä¢ Foco em SP, PE, MG, GO (3.000 empresas)",
            "",
            "üéØ SOM (Serviceable Obtainable Market - Ano 3): R$ 43,2 milh√µes",
            "   ‚Ä¢ Meta: 120 clientes pagantes (4% do SAM)",
            "   ‚Ä¢ Proje√ß√£o conservadora baseada em taxa de convers√£o de 2%"
        ],
        "Mercado crescendo 15% a.a. (expans√£o do agroneg√≥cio)"
    )

    # Slide 7: Concorr√™ncia
    add_two_column_slide(
        "‚öîÔ∏è An√°lise Competitiva",
        [
            "üî¥ Concorrentes Indiretos:",
            "‚Ä¢ Sistemas ERP (SAP, TOTVS)",
            "‚Ä¢ Consultorias fiscais",
            "‚Ä¢ Softwares de auditoria",
            "",
            "‚ö†Ô∏è Limita√ß√µes deles:",
            "‚Ä¢ Gen√©ricos (n√£o espec√≠ficos)",
            "‚Ä¢ Caros (R$ 50k+ setup)",
            "‚Ä¢ Sem IA integrada",
            "‚Ä¢ Valida√ß√£o manual",
            "‚Ä¢ Sem an√°lise de dados"
        ],
        [
            "‚úÖ Nossos Diferenciais:",
            "‚Ä¢ IA multi-provider",
            "‚Ä¢ Espec√≠fico para setor",
            "‚Ä¢ Valida√ß√£o h√≠brida",
            "‚Ä¢ Setup em 5 minutos",
            "‚Ä¢ Pre√ßo acess√≠vel",
            "‚Ä¢ Open source core",
            "‚Ä¢ EDA + Valida√ß√£o unificado",
            "",
            "üéØ Vantagem competitiva:",
            "‚Ä¢ 10x mais r√°pido",
            "‚Ä¢ 5x mais barato"
        ]
    )

    # Slide 8: Estrat√©gia de Go-to-Market
    add_content_slide(
        "üöÄ Estrat√©gia de Crescimento",
        [
            "üìÖ Roadmap de Lan√ßamento:",
            "   ‚Ä¢ Q1 2026: MVP + 10 clientes beta (valida√ß√£o)",
            "   ‚Ä¢ Q2 2026: Lan√ßamento comercial + 30 clientes",
            "   ‚Ä¢ Q3-Q4 2026: Expans√£o para MG e GO + 60 clientes",
            "   ‚Ä¢ 2027: Expans√£o para outros setores (gr√£os, carnes)",
            "",
            "üì¢ Canais de Aquisi√ß√£o:",
            "   ‚Ä¢ Marketing de conte√∫do (blog t√©cnico sobre compliance)",
            "   ‚Ä¢ Parcerias com associa√ß√µes do setor (UNICA, ORPLANA)",
            "   ‚Ä¢ LinkedIn Ads (decisores de TI e contabilidade)",
            "   ‚Ä¢ Eventos do setor (Fenasucro, Datagro)"
        ],
        "Meta Ano 1: 30 clientes | ARR: R$ 539.280"
    )

    # Slide 9: Tra√ß√£o
    add_content_slide(
        "üìà Tra√ß√£o e Valida√ß√£o",
        [
            "‚úÖ Produto:",
            "   ‚Ä¢ v1.2.0 em produ√ß√£o (Production Ready)",
            "   ‚Ä¢ 5 provedores de IA integrados",
            "   ‚Ä¢ Score de qualidade: 8.9/10",
            "   ‚Ä¢ 100% dos testes automatizados passando",
            "",
            "‚úÖ Valida√ß√£o de Mercado:",
            "   ‚Ä¢ 3 LOIs (Letters of Intent) assinadas",
            "   ‚Ä¢ 15 entrevistas com potenciais clientes",
            "   ‚Ä¢ 8/10 validaram a dor como cr√≠tica",
            "   ‚Ä¢ Dispostos a pagar R$ 1.000-2.000/m√™s",
            "",
            "‚úÖ Equipe:",
            "   ‚Ä¢ Time t√©cnico completo (ver pr√≥ximo slide)"
        ],
        "GitHub: 100+ commits | C√≥digo aberto para auditoria"
    )

    # Slide 10: Equipe
    add_content_slide(
        "üë• Equipe Prompt Pioneers",
        [
            "üéì Forma√ß√£o Acad√™mica:",
            "   ‚Ä¢ Especializa√ß√£o em Intelig√™ncia Artificial",
            "   ‚Ä¢ Background em Ci√™ncia da Computa√ß√£o e Engenharia",
            "",
            "üíº Experi√™ncia:",
            "   ‚Ä¢ 5+ anos em desenvolvimento de sistemas empresariais",
            "   ‚Ä¢ Expertise em IA, LangChain e arquitetura de software",
            "   ‚Ä¢ Conhecimento profundo em legisla√ß√£o fiscal brasileira",
            "",
            "üèÜ Compet√™ncias T√©cnicas:",
            "   ‚Ä¢ Python, Machine Learning, LLMs",
            "   ‚Ä¢ Clean Architecture, DDD, TDD",
            "   ‚Ä¢ DevOps, CI/CD, Cloud (AWS/GCP)"
        ],
        "Equipe multidisciplinar: Tech + Fiscal + Neg√≥cios"
    )

    # Slide 11: Finan√ßas
    add_content_slide(
        "üí∞ Proje√ß√µes Financeiras (3 anos)",
        [
            "üìä Receita Anual Recorrente (ARR):",
            "   ‚Ä¢ Ano 1: R$ 539.280 (30 clientes)",
            "   ‚Ä¢ Ano 2: R$ 2.157.120 (120 clientes)",
            "   ‚Ä¢ Ano 3: R$ 4.314.240 (240 clientes)",
            "",
            "üí∏ Custos Operacionais:",
            "   ‚Ä¢ Infraestrutura Cloud: R$ 5.000/m√™s (ano 1)",
            "   ‚Ä¢ APIs IA (Gemini/OpenAI): R$ 2.000/m√™s",
            "   ‚Ä¢ Equipe (3 pessoas): R$ 45.000/m√™s",
            "   ‚Ä¢ Marketing e Vendas: 30% da receita",
            "",
            "üìà EBITDA:",
            "   ‚Ä¢ Ano 1: Breakeven | Ano 2: +R$ 648k | Ano 3: +R$ 1.7M"
        ],
        "Margem EBITDA Ano 3: 40%"
    )

    # Slide 12: Investimento
    add_content_slide(
        "üíé A Oportunidade de Investimento",
        [
            "üíµ Capta√ß√£o: R$ 500.000",
            "",
            "üìä Equity Oferecido: 15%",
            "",
            "üéØ Uso dos Recursos:",
            "   ‚Ä¢ 40% - Desenvolvimento de produto (v2.0 com mais setores)",
            "   ‚Ä¢ 35% - Marketing e Vendas (aquisi√ß√£o de clientes)",
            "   ‚Ä¢ 15% - Infraestrutura e Opera√ß√µes",
            "   ‚Ä¢ 10% - Capital de giro",
            "",
            "üöÄ Marcos (Milestones):",
            "   ‚Ä¢ 6 meses: 30 clientes pagantes",
            "   ‚Ä¢ 12 meses: ARR de R$ 540k",
            "   ‚Ä¢ 18 meses: Expans√£o para 3 novos estados"
        ],
        "Valuation pr√©-money: R$ 2,8 milh√µes"
    )

    # Slide 13: Retorno do Investimento
    add_content_slide(
        "üìä Retorno Esperado para Investidor",
        [
            "üí∞ Investimento: R$ 500.000 por 15% equity",
            "",
            "üìà Cen√°rio Conservador (Ano 5):",
            "   ‚Ä¢ ARR: R$ 10 milh√µes",
            "   ‚Ä¢ Valuation (m√∫ltiplo 5x): R$ 50 milh√µes",
            "   ‚Ä¢ Valor da participa√ß√£o: R$ 7,5 milh√µes",
            "   ‚Ä¢ ROI: 15x em 5 anos (215% TIR)",
            "",
            "üöÄ Cen√°rio Otimista (Ano 5):",
            "   ‚Ä¢ ARR: R$ 25 milh√µes (expans√£o para 5 setores)",
            "   ‚Ä¢ Valuation (m√∫ltiplo 6x): R$ 150 milh√µes",
            "   ‚Ä¢ Valor da participa√ß√£o: R$ 22,5 milh√µes",
            "   ‚Ä¢ ROI: 45x em 5 anos (380% TIR)"
        ],
        "Estrat√©gia de sa√≠da: M&A ou IPO em 5-7 anos"
    )

    # Slide 14: Por que Agora?
    add_content_slide(
        "‚è∞ Por que Investir Agora?",
        [
            "‚úÖ Timing Perfeito:",
            "   ‚Ä¢ IA generativa em ponto de inflex√£o (Gemini, GPT-4, Claude)",
            "   ‚Ä¢ Setor sucroalcooleiro em expans√£o (15% a.a.)",
            "   ‚Ä¢ Governo aumentando fiscaliza√ß√£o (Reforma Tribut√°ria 2026)",
            "",
            "‚úÖ Tra√ß√£o Comprovada:",
            "   ‚Ä¢ Produto funcional em produ√ß√£o",
            "   ‚Ä¢ 3 LOIs de clientes enterprise",
            "   ‚Ä¢ Valida√ß√£o de mercado completa",
            "",
            "‚úÖ Barreiras de Entrada:",
            "   ‚Ä¢ Conhecimento t√©cnico profundo (IA + Fiscal)",
            "   ‚Ä¢ Base de regras propriet√°ria (35+ regras validadas)",
            "   ‚Ä¢ Network no setor"
        ],
        "Janela de oportunidade: 12-18 meses antes da concorr√™ncia"
    )

    # Slide 15: Resumo da Oportunidade
    add_content_slide(
        "üéØ Resumo: Por que FiscoLayer?",
        [
            "üí° Problema Real e Validado:",
            "   ‚Ä¢ R$ 15.000/m√™s em custos de auditoria manual por empresa",
            "   ‚Ä¢ Multas fiscais: m√©dia R$ 50.000/ano",
            "",
            "üöÄ Solu√ß√£o √önica:",
            "   ‚Ä¢ 99% mais r√°pido que valida√ß√£o manual",
            "   ‚Ä¢ 5x mais barato que concorrentes",
            "   ‚Ä¢ IA multi-provider (sem vendor lock-in)",
            "",
            "üí∞ Mercado Bilion√°rio:",
            "   ‚Ä¢ TAM: R$ 2,4 bilh√µes/ano",
            "   ‚Ä¢ Crescimento: 15% a.a.",
            "",
            "üìà Retorno Atrativo:",
            "   ‚Ä¢ ROI: 15-45x em 5 anos",
            "   ‚Ä¢ Capta√ß√£o: R$ 500k por 15% equity"
        ],
        "FiscoLayer: O futuro da automa√ß√£o fiscal no Brasil"
    )

    # Slide 16: Contato
    add_title_slide(
        "üìû Vamos Conversar?",
        "GitHub: github.com/ctadeu-almeida/FiscoLayer\nPrompt Pioneers | I2A2 - Agentes Inteligentes"
    )

    # Salvar apresenta√ß√£o
    filename = "I2A2_Agentes_Inteligentes_Projeto_Final_PROMPT_PIONEERS.pptx"
    prs.save(filename)
    print(f"[OK] Pitch Deck criado com sucesso: {filename}")
    print(f"[INFO] Total de slides: {len(prs.slides)}")

if __name__ == "__main__":
    create_pitch_deck()
